<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Privilege Escalation using text editors - My Portfolio Wiki</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Privilege Escalation using text editors";
        var mkdocs_page_input_path = "markdown\\Privilege Escalation using text editors.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> My Portfolio Wiki
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Coding Language</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../python/">Python</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../bash/">Bash</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../">Markdown</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">My Portfolio Wiki</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Privilege Escalation using text editors</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="privilege-escalation-in-a-linux-system">Privilege Escalation in a Linux System.</h2>
<p><a href="https://medium.com/schkn/linux-privilege-escalation-using-text-editors-and-files-part-1-a8373396708d">link to guide</a></p>
<p>Scenario — 1: Using .sh file for privilege escalation</p>
<p>There was this box which I was trying to hack and get the root access. So basically, I was able to execute the following commands and files as root in the user’s shell.
Privilege escalation using .sh</p>
<p>From the above, you can tell that the user haris is able to execute the file test.sh as root. Which means that if he executes the file using sudo it will be equivalent to the root executing the file. Also, the NOPASSWD specifies that no password will be asked while executing the file.</p>
<p>This is a very insecure way of allowing a user to access a file.</p>
<p>Using above permissions, the user can easily get into root, just by doing some simple modifications in the test.sh and then executing it with sudo. Let’s first see the contents of the file and let’s try executing it.</p>
<p>As you can see it is just printing a welcome message and nothing else.</p>
<p>So how can we use this file in our favour?</p>
<p>Well, the answer is very simple!</p>
<p>Since it is a bash file so commands inside it will get executed, and if we execute the file as root, then all the commands inside it will also get executed as root. So, let’s take advantage of that and append /bin/bash -i to the file. This will execute bash as root, which in turn will open the root shell.</p>
<p>And we got the root!</p>
<p>This is a pretty much simple scenario and is very easy to exploit. These type of mistakes are often done by administrators and are used by other system users and testers to get into the root.
Scenario — 2: Using nano for privilege escalation.</p>
<pre><code>Note: Root Access to any text editor other than nano can also be used to exploit such situations.
</code></pre>
<p>Now let’s take a look at a little more complicated situation.</p>
<p>In this case, the user has access to nano text editor as root but only in a specific directory.
Privilege escalation using nano</p>
<p>The user can only use sudo in /var/opt directory, if the user will try to use it some other place, he will be restricted.</p>
<p>Now if the /var/opt/* part was not mentioned in the /etc/sudoers file, then it would be a pretty much easy deal to exploit it, as you would be able to edit any system file as root. But that’s not the case over here. it will take a little more creative approach to exploit it.</p>
<p>Let me give you a hint: how do you traverse backwards in a directory? For example, if suppose you are in /home/user/xyz/ , then how would you traverse one step backwards to /home/user ?</p>
<p>The answer is simple!</p>
<p>You can simply do cd .. or cd /home/user/xyz/../ .</p>
<p>That is the trick which can be used to exploit it.</p>
<p>So, let’s try to edit the sudoers file and try to add more privileges to the user account. But if you will try to execute the following command:</p>
<p>sudo nano /etc/sudoers</p>
<p>Then it will get restricted and you will get a permission denied message. But as we know, we can execute nano as root in /var/opt . So you can use it to traverse backwards and reach onto the sudoers file as shown below:</p>
<p>sudo nano /var/opt/../../etc/sudoers</p>
<p>Yes, that’s the trick ;)</p>
<p>Now the moment you execute it, it will open the sudoers file inside the nano text editor as root. Now modify the file and give the user haris the root privileges by modifying the file as mentioned below:</p>
<p>Replace the marked line with haris ALL=(ALL) NOPASSWD:ALL , save the file and run sudo -i . This will give you the root shell.
Scenario — 3: Using Vim for privilege escalation.</p>
<p>We are going to create a similar scenario as the previous one. But in this case, we have access to the Vim editor instead of nano and no directory restrictions are specified.
Privilege escalation using Vim editor</p>
<p>Now you must be thinking, we can repeat the same steps we did in scenario 2 to get into the root and in this case, there is no directory restriction too so it will be a straightforward approach, which is correct but there exists a simpler and easy way to do it when you have access to Vim.</p>
<p>Vim is a very versatile text editor which have many awesome functionalities including the ability to open a shell inside it. Yes, you read it right this is what we just needed. So, to open vim as root we can use the following command.</p>
<p>sudo vi test.sh</p>
<p>As soon as you will execute it, vi window will open, now you need to switch into the command mode you can do that by pressing ESC key. In command mode, use :!bash command this will open a root shell.</p>
<p>There is one more shortcut which you can use when you have access to vim, you can use the following command to trigger the root shell using vim.</p>
<p>sudo vi -c '!bash'</p>
<p>There are many Linux executable other than text editors which you can use for privilege escalation. I will try to include them and many more other techniques in the next part.</p>
<p>If you guys have any other ideas which I should mention then please comment them down below.</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
